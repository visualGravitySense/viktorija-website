# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Supabase –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º

## üìã –û–±–∑–æ—Ä

Supabase –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ –ø—Ä–æ–µ–∫—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º —Å–∞–π—Ç–∞. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –≤—Å–µ–º–∏ —Ç–µ–∫—Å—Ç–∞–º–∏, —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏, –±–ª–æ–≥-–ø–æ—Å—Ç–∞–º–∏, FAQ, –æ—Ç–∑—ã–≤–∞–º–∏ –∏ –¥—Ä—É–≥–∏–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Supabase.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ Supabase

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [supabase.com](https://supabase.com)
2. –°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç –∏–ª–∏ –≤–æ–π–¥–∏—Ç–µ
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
4. –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–≥–∏–æ–Ω (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –±–ª–∏–∂–∞–π—à–∏–π –∫ –≤–∞—à–µ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏)
5. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–ª—é—á–µ–π API

1. –í –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Supabase –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings** ‚Üí **API**
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è:
   - **Project URL** (—ç—Ç–æ –≤–∞—à `VITE_SUPABASE_URL`)
   - **anon/public key** (—ç—Ç–æ –≤–∞—à `VITE_SUPABASE_ANON_KEY`)

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env.local` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ (–µ—Å–ª–∏ –µ–≥–æ –µ—â–µ –Ω–µ—Ç) –∏ –¥–æ–±–∞–≤—å—Ç–µ:

```env
VITE_SUPABASE_URL=https://your-project-id.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key-here
```

**–í–∞–∂–Ω–æ**: –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Ñ–∞–π–ª `.env.local` –≤ Git! –û–Ω —É–∂–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ `.gitignore`.

### 4. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –≤ Supabase

#### –í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ SQL Editor (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –í –ø–∞–Ω–µ–ª–∏ Supabase –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **SQL Editor**
2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π SQL –∑–∞–ø—Ä–æ—Å:

```sql
-- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
CREATE TABLE IF NOT EXISTS content (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  type TEXT NOT NULL CHECK (type IN ('page', 'blog_post', 'faq', 'testimonial', 'instructor', 'course', 'pricing', 'announcement')),
  language TEXT NOT NULL CHECK (language IN ('ru', 'et', 'en')),
  title TEXT NOT NULL,
  content TEXT NOT NULL,
  slug TEXT,
  metadata JSONB DEFAULT '{}',
  published BOOLEAN DEFAULT false,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
CREATE INDEX IF NOT EXISTS idx_content_type ON content(type);
CREATE INDEX IF NOT EXISTS idx_content_language ON content(language);
CREATE INDEX IF NOT EXISTS idx_content_slug ON content(slug);
CREATE INDEX IF NOT EXISTS idx_content_published ON content(published);
CREATE INDEX IF NOT EXISTS idx_content_type_language ON content(type, language);

-- –°–æ–∑–¥–∞–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ –¥–ª—è slug + type + language
CREATE UNIQUE INDEX IF NOT EXISTS idx_content_slug_type_language 
ON content(slug, type, language) 
WHERE slug IS NOT NULL;

-- –í–∫–ª—é—á–µ–Ω–∏–µ Row Level Security (RLS)
ALTER TABLE content ENABLE ROW LEVEL SECURITY;

-- –ü–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è: –≤—Å–µ –º–æ–≥—É—Ç —á–∏—Ç–∞—Ç—å –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
CREATE POLICY "Anyone can read published content"
ON content FOR SELECT
USING (published = true);

-- –ü–æ–ª–∏—Ç–∏–∫–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏: —Ç–æ–ª—å–∫–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å/–æ–±–Ω–æ–≤–ª—è—Ç—å
-- –í–ê–ñ–ù–û: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —ç—Ç–∏ –ø–æ–ª–∏—Ç–∏–∫–∏ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –≤–∞—à–∏–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
CREATE POLICY "Authenticated users can insert content"
ON content FOR INSERT
WITH CHECK (auth.role() = 'authenticated');

CREATE POLICY "Authenticated users can update content"
ON content FOR UPDATE
USING (auth.role() = 'authenticated');

CREATE POLICY "Authenticated users can delete content"
ON content FOR DELETE
USING (auth.role() = 'authenticated');

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è updated_at
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

-- –¢—Ä–∏–≥–≥–µ—Ä –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è updated_at
CREATE TRIGGER update_content_updated_at
BEFORE UPDATE ON content
FOR EACH ROW
EXECUTE FUNCTION update_updated_at_column();
```

#### –í–∞—Ä–∏–∞–Ω—Ç B: –ß–µ—Ä–µ–∑ Table Editor

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Table Editor** –≤ –ø–∞–Ω–µ–ª–∏ Supabase
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É `content` —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏:

| Column Name | Type | Default | Nullable | Unique |
|------------|------|---------|----------|--------|
| id | uuid | gen_random_uuid() | No | Yes (Primary Key) |
| type | text | - | No | No |
| language | text | - | No | No |
| title | text | - | No | No |
| content | text | - | No | No |
| slug | text | - | Yes | No |
| metadata | jsonb | '{}' | Yes | No |
| published | boolean | false | No | No |
| created_at | timestamptz | now() | No | No |
| updated_at | timestamptz | now() | No | No |

3. –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (constraints):
   - –î–ª—è `type`: `CHECK (type IN ('page', 'blog_post', 'faq', 'testimonial', 'instructor', 'course', 'pricing', 'announcement'))`
   - –î–ª—è `language`: `CHECK (language IN ('ru', 'et', 'en'))`

4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Row Level Security (RLS) –≤ —Ä–∞–∑–¥–µ–ª–µ **Authentication** ‚Üí **Policies**

### 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —É–ø—Ä–∞–≤–ª—è—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Authentication** ‚Üí **Providers**
2. –í–∫–ª—é—á–∏—Ç–µ –Ω—É–∂–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã (Email, Google, –∏ —Ç.–¥.)
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –≤ **Authentication** ‚Üí **Policies**

## üìö –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```typescript
import { useContent } from '../hooks/useContent';
import { ContentService } from '../services/contentService';

// –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ React
function MyComponent() {
  const { content, loading, error } = useContent('faq', 'ru');
  
  if (loading) return <div>–ó–∞–≥—Ä—É–∑–∫–∞...</div>;
  if (error) return <div>–û—à–∏–±–∫–∞: {error.message}</div>;
  
  return (
    <div>
      {content.map((item) => (
        <div key={item.id}>
          <h3>{item.title}</h3>
          <p>{item.content}</p>
        </div>
      ))}
    </div>
  );
}
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º

```typescript
import { useContentManagement } from '../hooks/useContentManagement';

function ContentEditor() {
  const { createContent, updateContent, deleteContent, loading } = useContentManagement();
  
  const handleCreate = async () => {
    await createContent({
      type: 'faq',
      language: 'ru',
      title: '–ù–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å',
      content: '–û—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å',
      published: true,
    });
  };
  
  // ...
}
```

### –ü—Ä—è–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞

```typescript
import { ContentService } from '../services/contentService';

// –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ FAQ –Ω–∞ —Ä—É—Å—Å–∫–æ–º
const faqs = await ContentService.getFAQs('ru');

// –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
const page = await ContentService.getContentBySlug('about', 'page', 'ru');

// –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
const newContent = await ContentService.createContent({
  type: 'blog_post',
  language: 'ru',
  title: '–ù–æ–≤—ã–π –ø–æ—Å—Ç',
  content: '–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ø–æ—Å—Ç–∞',
  slug: 'new-post',
  published: true,
});
```

## üéØ –¢–∏–ø—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞

–ü—Ä–æ–µ–∫—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∏–ø—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞:

- **page** - –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–û –Ω–∞—Å, –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ —Ç.–¥.)
- **blog_post** - –ë–ª–æ–≥ –ø–æ—Å—Ç—ã
- **faq** - –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã
- **testimonial** - –û—Ç–∑—ã–≤—ã –∫–ª–∏–µ–Ω—Ç–æ–≤
- **instructor** - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞—Ö
- **course** - –û–ø–∏—Å–∞–Ω–∏—è –∫—É—Ä—Å–æ–≤
- **pricing** - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ü–µ–Ω–∞—Ö
- **announcement** - –û–±—ä—è–≤–ª–µ–Ω–∏—è

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **Row Level Security (RLS)** –≤–∫–ª—é—á–µ–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
2. –¢–æ–ª—å–∫–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —á—Ç–µ–Ω–∏—è –≤—Å–µ–º
3. –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è —Ç—Ä–µ–±—É–µ—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –≤–∞—à–∏–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏

## üìù –ü—Ä–∏–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö

### FAQ

```json
{
  "type": "faq",
  "language": "ru",
  "title": "–°–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç –æ–±—É—á–µ–Ω–∏–µ?",
  "content": "–°—Ç–æ–∏–º–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏...",
  "metadata": {
    "category": "pricing",
    "order": 1
  },
  "published": true
}
```

### –ë–ª–æ–≥ –ø–æ—Å—Ç

```json
{
  "type": "blog_post",
  "language": "ru",
  "title": "–ù–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–æ—Ä–æ–∂–Ω–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è",
  "content": "–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç —Å—Ç–∞—Ç—å–∏...",
  "slug": "new-traffic-rules-2024",
  "metadata": {
    "excerpt": "–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ",
    "featured_image": "/images/blog/new-rules.jpg",
    "author": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤"
  },
  "published": true
}
```

### –û—Ç–∑—ã–≤

```json
{
  "type": "testimonial",
  "language": "ru",
  "title": "–û—Ç–ª–∏—á–Ω–∞—è –∞–≤—Ç–æ—à–∫–æ–ª–∞!",
  "content": "–û—á–µ–Ω—å –¥–æ–≤–æ–ª–µ–Ω –æ–±—É—á–µ–Ω–∏–µ–º...",
  "metadata": {
    "author_name": "–ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤",
    "author_role": "–°—Ç—É–¥–µ–Ω—Ç",
    "rating": 5
  },
  "published": true
}
```

## üõ†Ô∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è (Realtime)

Supabase –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –í—ã –º–æ–∂–µ—Ç–µ –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

```typescript
import { supabase } from '../lib/supabase';

supabase
  .channel('content-changes')
  .on('postgres_changes', 
    { event: '*', schema: 'public', table: 'content' },
    (payload) => {
      console.log('Content changed:', payload);
    }
  )
  .subscribe();
```

### –•—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ (Storage)

–î–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Supabase Storage:

```typescript
import { supabase } from '../lib/supabase';

// –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞
const { data, error } = await supabase.storage
  .from('content-images')
  .upload('path/to/file.jpg', file);
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã:
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Supabase: https://supabase.com/docs
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞: —Å–º. README.md

